<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<link href="/css/style.css" rel="stylesheet" type="text/css"></link>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>tiny.io</title>
<script src="/js/jquery.js" type="text/javascript"></script>
<script src="/js/json.js" type="text/javascript"></script>
<script src="/js/template.js" type="text/javascript"></script>
<script src="/js/jquery.form.js" type="text/javascript"></script>

<script type="text/javascript">
function showForm() {
  var newpane = expand_template("submit", {});
  $("#pane").html(newpane);
  $("#createForm").submit(function(){
    var queryString = $(this).formSerialize();
    $.post('/api/shorten', queryString, showResults, "json");
    //$(this).resetForm();
    return false;
  });
}

function showResults(response) {
  var newpane = expand_template("results", {response:response});;
  $("#pane").html(newpane);
  $("#retry").click(function() {alert("oh!");});
}

$(document).ready(function(){
  showForm();
});
</script>

<script type="text/html" id="results">
    <table width="400px" align="center" cellpadding="5"><tr><td>
    <tr><td align="center">{%= response.message %}</td></tr>
{% if (response.tinyurl) { %}
    <tr><td align="center">
     <a href="{%= response.tinyurl %}" target="_blank">{%= response.tinyurl %}</a>
    </td></tr>
{% } %}
    <tr><td align="center">
       <a href="javascript:void(0)" onclick="showForm();">Return to form.</a> 
    </td></tr>
    </table>
</script>

<script type="text/html" id="submit">
  <form id="createForm">
    <table width="400px" align="center" cellpadding="5"><tr><td align="center">
    <input type="text" name="url" size="54" />
    <hr/>
    <input type="submit" name="submit" value="Make Tiny URL!" style="position:absolute; margin-top:12px">
    <small>
    <table align="right">
    <tr>
    <td align="right">User Key</td><td><input type="password" name="key" value="" size="20" maxlength="40"> (required)</td>
    </tr>
    <tr>
    <td align="right"><tt>http://tiny.io/</tt></td><td><input type="tiny" name="tiny" value="" size="20" maxlength="40"> (optional)</td>
    </tr>
    </table>
    </small>
    </td></tr></table>
  </form>
</script>
</head>

<body>
<div style="width:600px; margin:0 auto;">
<table>
<tr valign="top">
<td>
<img src="img/nukular-75.png" alt="nukular"/>
</td>
<td align="right">
<h1>tiny.io</h1>
<p>a little URL shortener</p>
</td>
<td>
<div id="pane" style="margin-left:10px; width:400px; min-height:120px; background-color:#E0E0F0">
</div>
</td>
</tr>
</table>
</div>
</body>
</html>
